# プロジェクト固有の Claude 指示

このファイルは「バイブコーダーに贈るバックエンド開発入門講座」プロジェクト専用の指示です。

---

## プロジェクト概要

### プロジェクトの目的

このプロジェクトは、**バイブコーディング（AI を活用したコーディングスタイル）を実践する人**に向けた、バックエンド開発の入門講座を作成することを目的としています。

### ターゲット読者

- AI と協働してコードを書く新世代のエンジニア
- 「AI がコードを書いてくれるのに、なぜ基礎を学ぶ必要があるの？」という疑問を持つ人
- 効率的に AI を使いこなして、セキュアで信頼性の高いバックエンドを構築したい人
- フロントエンド経験者で、サーバーサイドの知識を得たい人

### プロジェクトの特徴

従来の教材とは異なり、以下の特徴を持っています：

- **AI との協働前提**：すべてを自分で書くのではなく、AI と一緒に開発する
- **理解と応用重視**：暗記ではなく、「なぜ」を理解する
- **セキュリティ最優先**：バックエンドならではの脆弱性対策を徹底的に学ぶ
- **実践的な組み合わせ**：技術単体ではなく、実際のプロジェクトで使える知識
- **バイブコーダー視点**：各レッスンに「AI への指示例」「生成コードのチェックポイント」を含める
- **MAMP環境での学習**：ローカルで素早く始められる開発環境

---

## 教材作成のガイドライン

### 文体・トーン

- **明朗快活**な口調で記述する
- 学習者に寄り添い、共感する表現を使う
- 「できる」「楽しい」「わくわくする」といったポジティブな言葉を積極的に使う
- 専門用語を使う際は、必ず平易な言葉で説明を添える
- **セキュリティの重要性**は真剣に、でも怖がらせすぎずに伝える

### 良い例・悪い例

```text
悪い例（堅苦しい、専門的すぎる）:
「プリペアドステートメントはSQL文とデータを分離することで、
入力値がSQL文として解釈されることを防ぐセキュリティ機構である。」

良い例（分かりやすい、親しみやすい）:
「プリペアドステートメントは、悪意のあるコードを防ぐ『防弾チョッキ』みたいなもの！
データベースに『これは命令じゃなくてデータだよ』って教えてあげることで、
攻撃者が変なコードを送り込めないようにしてくれるんだ！」
```

```text
悪い例（セキュリティを軽視）:
「とりあえず動けばOK！」

良い例（セキュリティ意識を自然に醸成）:
「動いた！すごい！でも、ちょっと待って！
ユーザーの入力をそのまま使うと危ないかも。安全な書き方をチェックしよう！」
```

---

## 各レッスンの統一フォーマット

すべてのレッスンは以下の構成で統一してください：

### 1. レッスンタイトルと目標

レッスン名と学習目標を明記する。目標は 1-2 文で簡潔に。

### 2. 導入（Why）

- なぜこの技術を学ぶのか
- 実際にどんな場面で使うのか
- 学ぶことで何ができるようになるのか
- **バックエンド開発における重要性**（セキュリティ、パフォーマンス、保守性など）

### 3. 基礎知識（What）

- 技術の基本的な説明
- 重要な概念やキーワードの解説
- 図解や例え話を積極的に使う
- **セキュリティリスクや注意点**を必ず含める

### 4. コード例（How）

実際に動くコード例を提示：

- シンプルで理解しやすいコード
- コメントで各部分の役割を説明
- 実行結果も示す
- **セキュアなコードを示す**（脆弱なコードは「悪い例」として明示）

### 5. バイブコーディング実践（最重要セクション！）

このプロジェクトの特徴的なセクション：

#### AI への指示例

「こう伝えると良いコードが生成される」という具体例を示す：

```text
良い指示の例:
「MySQLのusersテーブルからメールアドレスでユーザーを検索するPHPコードを書いてください。
SQLインジェクション対策として、必ずプリペアドステートメントを使ってください。」

曖昧な指示の例:
「ユーザーを検索するコードを書いて」

危険な指示の例（セキュリティ指示なし）:
「入力されたメールアドレスでユーザーを検索して」
```

#### 生成されたコードのチェックポイント

AI が生成したコードのどこを見るべきか、チェックポイントを示す：

**セキュリティチェック（最優先）**
- [ ] SQLインジェクション対策：プリペアドステートメントが使われているか
- [ ] XSS対策：htmlspecialchars() が使われているか
- [ ] パスワード：ハッシュ化されているか（password_hash使用）
- [ ] セッション：session_regenerate_id() が適切に使われているか

**機能チェック**
- [ ] エラーハンドリング：try-catch が適切に使われているか
- [ ] データベース接続：接続エラーの処理があるか
- [ ] バリデーション：入力値のチェックがあるか

**コード品質チェック**
- [ ] コメント：重要な処理に説明があるか
- [ ] 変数名：わかりやすい名前か
- [ ] 重複：同じコードが繰り返されていないか

#### よくある問題と修正方法

AI が生成したコードで起こりがちな問題と、その修正方法を説明。

例：

**問題：SQLインジェクション脆弱性**
```php
// 悪い例（AIが生成しがちな危険なコード）
$email = $_POST['email'];
$sql = "SELECT * FROM users WHERE email = '$email'";
$result = $conn->query($sql);
```

**原因**：ユーザー入力を直接SQL文に埋め込んでいる

**修正**：プリペアドステートメントを使う
```php
// 良い例（セキュアなコード）
$email = $_POST['email'];
$stmt = $conn->prepare("SELECT * FROM users WHERE email = ?");
$stmt->bind_param("s", $email);
$stmt->execute();
$result = $stmt->get_result();
```

**AIへの修正指示**：
「SQLインジェクション対策のため、プリペアドステートメントに書き換えてください」

### 6. 演習

演習の内容は教材とは別のファイルに作成し、教材からリンクする。

- 基礎編：簡単な練習問題（3-5 問）
- 応用編：少し難易度の高い課題（1-2 問）
- セキュリティチャレンジ：脆弱なコードを修正する課題（1-2問）
- 総合チャレンジ：創造性を発揮できる課題（任意）

### 7. まとめ

このレッスンで学んだことを箇条書きで整理し、次のステップへ誘導する。

---

## バイブコーダー向けの特別セクション

各レッスンには必ず以下の要素を含めてください：

### 1. AI への指示例

- 具体的で明確な指示の例を示す
- 良い指示と悪い指示を対比させる
- **セキュリティ要件を含めた指示**の重要性を強調
- 技術用語を使った指示の効果を示す

### 2. コードリーディングのポイント

- 生成されたコードのどこを見るべきか
- 「このコードは良い/悪い」の判断基準
- **セキュリティ脆弱性の見つけ方**
- 重要な部分とそうでない部分の見分け方

### 3. セキュリティチェックリスト

バックエンド開発では特に重要なセクション：

- SQLインジェクション対策チェック
- XSS対策チェック
- CSRF対策チェック
- パスワード保護チェック
- セッション管理チェック
- ファイル操作の安全性チェック

### 4. カスタマイズポイント

- 自分で微調整する際にいじる箇所
- 値を変えると何が変わるか
- よく調整する項目のリスト
- パフォーマンス改善のポイント

### 5. よくあるトラブル

- AI が生成したコードで起こりがちな問題
- その原因と修正方法
- デバッグのヒント
- エラーメッセージの読み方

---

## 技術的な方針

### コード例の書き方

1. **実際に動くコードを提示する**

   - MAMP環境でコピペして試せるようにする
   - 必要な PHP と SQL の両方を含める
   - できるだけシンプルに保つ
   - **セキュアなコードを基本とする**

2. **コメントを適切に入れる**

   - 重要な行には必ずコメントを付ける
   - 日本語のコメントを使う
   - 「なぜそうするか」を説明する
   - **セキュリティ対策部分には必ずコメントを付ける**

3. **段階的に複雑にする**

   - まず最小限のコードから始める
   - 徐々に機能を追加していく
   - 各ステップで何が変わったか明示する
   - **セキュリティ対策を後付けではなく、最初から組み込む**

### 良いコード例の提示方法

```php
/* 悪い例：セキュリティ対策なし、いきなり複雑 */
<?php
$name = $_POST['name'];
$email = $_POST['email'];
$sql = "INSERT INTO users (name, email) VALUES ('$name', '$email')";
$conn->query($sql);
?>

/* 良い例：段階的に説明、セキュリティ対策あり */

// ステップ1：まずデータベース接続
<?php
$conn = new mysqli("localhost", "root", "root", "mydb");
?>

// ステップ2：ユーザー入力を受け取る
<?php
$name = $_POST['name'];
$email = $_POST['email'];
?>

// ステップ3：バリデーション（入力チェック）
<?php
if (empty($name) || empty($email)) {
    die("名前とメールアドレスは必須です");
}
?>

// ステップ4：プリペアドステートメントで安全に保存（SQLインジェクション対策）
<?php
$stmt = $conn->prepare("INSERT INTO users (name, email) VALUES (?, ?)");
$stmt->bind_param("ss", $name, $email);
$stmt->execute();
?>

// ステップ5：結果を確認
<?php
if ($stmt->affected_rows > 0) {
    echo "登録成功！";
} else {
    echo "登録に失敗しました";
}
?>
```

### セキュアコードの原則

すべてのコード例で以下を守る：

1. **SQLインジェクション対策**
   - 必ずプリペアドステートメントを使う
   - 直接SQL文に変数を埋め込まない

2. **XSS対策**
   - 出力時に `htmlspecialchars()` を使う
   - ユーザー入力をそのまま表示しない

3. **パスワード保護**
   - `password_hash()` でハッシュ化
   - 平文では絶対に保存しない

4. **セッション管理**
   - `session_regenerate_id()` を使う
   - セッションハイジャック対策

5. **エラーハンドリング**
   - 本番環境では詳細なエラーを表示しない
   - エラーログに記録する

### ファイル・ディレクトリの命名規則

- **ディレクトリ名**：phase0-intro, phase1-php-basics のように小文字とハイフン
- **レッスンディレクトリ**：01-mamp-setup, 02-php-syntax のように番号付き
- **ファイル名**：README.md, index.php, config.php など、分かりやすい名前
- **画像ファイル**：lesson01-example.png のようにレッスン名を含める
- **SQLファイル**：create_table.sql, sample_data.sql など、目的がわかる名前

---

## プロジェクト構造の原則

### Phase 間の依存関係

- **Phase 0**: モチベーションと全体像の理解（必読）
- **Phase 1**: PHP基礎（Phase 2-5の前提、言語の基本）
- **Phase 2**: PHP発展（Phase 1の知識が必要、実践的な機能）
- **Phase 3**: MySQL基礎（Phase 5の前提、データベースの基本）
- **Phase 4**: MySQL発展（Phase 3の知識が必要、高度なクエリ）
- **Phase 5**: PHP+MySQL統合（Phase 1-4の知識が必要、CRUD実装）
- **Phase 6**: 実践プロジェクト（Phase 0-5の総まとめ）
- **Phase 7**: REST API（Phase 5の知識が必要、オプション）

### ディレクトリ構造の一貫性

各 Phase は以下の構造を守る：

```text
phaseXX-name/
├── README.md               # Phase全体の概要と学習ガイド
├── lessons/
│   ├── 01-topic/
│   │   ├── README.md       # レッスン教材
│   │   ├── exercises/      # 演習
│   │   │   ├── README.md   # 演習問題
│   │   │   └── solutions/  # 演習問題の解答例
│   │   │       ├── README.md # 解答例の解説
│   │   │       ├── 01-01.php
│   │   │       └── 01-02.php
│   │   └── resources/      # 教材で使用するSQLファイルなど
│   │       ├── sample.sql
│   │       └── images/
│   └── 02-topic/
└── projects/               # 実践プロジェクト
    ├── project01/
    │   ├── index.php
    │   ├── config.php
    │   └── database.sql
    └── project02/
```

---

## 避けるべきこと

### 1. 専門用語の羅列

```text
悪い例：
「PDOオブジェクトをインスタンス化し、DSNを指定して
データベースコネクションを確立する」

良い例：
「PDOっていう便利な道具を使って、データベースに接続するよ！
接続先の情報（どのデータベースか）を教えてあげればOK！」
```

### 2. 理論だけの説明

```text
悪い例：
「セッションはサーバー側で状態を保持する機構で...」

良い例：
「セッションを使うと、ログインした人が誰かを覚えておけるんだ！
実際にログイン機能を作ってみよう！」
```

### 3. セキュリティの軽視

```text
悪い例：
「とりあえず動くコードを書こう！」

良い例：
「動くコードを書こう！でも、セキュリティ対策も一緒にやるよ！
ちょっとした工夫で、すごく安全になるんだ！」
```

### 4. バイブコーディング視点の欠如

すべてのレッスンに「AI とどう協働するか」の視点を必ず含める。
技術の説明だけで終わらせない。
**特にセキュリティチェックの方法を必ず含める。**

### 5. 難易度の急激な上昇

前のレッスンで学んだことを前提に、少しずつ難易度を上げる。
いきなり複雑な例を出さない。

### 6. 実践から離れた内容

「実際のプロジェクトでは使わない」ような細かい仕様の説明は避ける。
実用的な知識を優先する。

### 7. 脆弱なコードの放置

```text
悪い例：
脆弱なコードを「まず動かす」ために提示し、修正を後回しにする

良い例：
最初からセキュアなコードを提示し、「なぜこう書くのか」を説明する
```

---

## 教材更新時の注意点

### 新しいレッスンを追加する時

1. 既存のフォーマットに従う
2. Phase 内での位置づけを明確にする
3. 前提知識と学習目標を明記する
4. 「バイブコーディング実践」セクションを必ず含める
5. **セキュリティチェックリスト**を必ず含める
6. MAMP環境で動作確認する

### 既存の教材を修正する時

1. 他のレッスンとの整合性を確認する
2. リンクが切れていないかチェックする
3. コード例が正しく動作するか確認する
4. **コード例にセキュリティ脆弱性がないか確認する**
5. 文体・トーンの一貫性を保つ

### 演習や課題を作成する時

1. 難易度を段階的に設定する（基礎 → 応用 → セキュリティ → チャレンジ）
2. 解答例を必ず用意する
3. AI を使った解決方法も示す
4. 「この演習で何を学ぶか」を明記する
5. **セキュリティに関する演習を必ず含める**

---

## デザイン・表現のガイドライン

### 絵文字の使用

プロジェクト全体で一貫した絵文字を使う：

- 🌟 Phase 0（導入）
- ⚡ Phase 1（PHP基礎）
- 🎮 Phase 2（PHP発展）
- 🗄️ Phase 3（MySQL基礎）
- 📊 Phase 4（MySQL発展）
- 🔗 Phase 5（PHP+MySQL統合）
- 🏗️ Phase 6（実践プロジェクト）
- 🌐 Phase 7（REST API）
- 🤖 AI に関する内容
- 💪 演習・チャレンジ
- ✅ チェックリスト、まとめ
- 💻 コード例、実践
- 💡 ヒント、Tips
- 🔒 セキュリティ関連
- ⚠️ 注意・警告
- 🚨 危険・脆弱性

### 強調表現

- **太字**：重要なキーワード、セキュリティ用語
- `コード`：技術用語、コマンド、関数名
- 引用：重要なポイントの強調
- リンク：参考資料、他のレッスンへの誘導

### 見出しレベル

```markdown
# レッスンタイトル（H1）

## 大セクション（H2）

### 中セクション（H3）

#### 小セクション（H4）
```

H4 より深い階層は使わない（読みづらくなるため）

---

## MAMP環境に関する記述

### MAMP環境の説明

すべてのコード例は以下の環境を前提とする：

- **MAMP**: Mac/Apache/MySQL/PHP
- **PHPバージョン**: 7.4以上（8.0推奨）
- **MySQLバージョン**: 5.7以上（8.0推奨）
- **ドキュメントルート**: `/Applications/MAMP/htdocs/`
- **phpMyAdmin**: データベース管理用
- **ポート**: Apache 8888, MySQL 8889（MAMPデフォルト）

### コード例のパス

```php
// 良い例：相対パスを使う
include 'config.php';
require_once 'functions.php';

// 避ける例：絶対パスを使う（環境依存）
include '/Applications/MAMP/htdocs/myproject/config.php';
```

### データベース接続の標準形

```php
// MAMP環境での標準的なデータベース接続
$host = 'localhost';
$port = '8889';  // MAMPのデフォルトポート
$dbname = 'mydb';
$username = 'root';
$password = 'root';  // MAMPのデフォルトパスワード

try {
    $pdo = new PDO(
        "mysql:host=$host;port=$port;dbname=$dbname;charset=utf8mb4",
        $username,
        $password,
        [PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION]
    );
} catch (PDOException $e) {
    die("データベース接続エラー: " . $e->getMessage());
}
```

---

## このプロジェクトのゴール

最終的に、このプロジェクトを通じて学習者が以下の状態になることを目指します：

1. **AI と効果的に協働できる**

   - 的確な指示が出せる
   - 生成されたコードを評価・修正できる
   - **セキュリティリスクを判断できる**

2. **バックエンド開発の基礎を理解している**

   - PHP/MySQL の基本が分かる
   - データベース設計ができる
   - **セキュアなコードが書ける**

3. **セキュリティ意識が高い**

   - SQLインジェクション、XSSなどの脆弱性を知っている
   - AI が生成したコードの脆弱性を発見できる
   - 適切な対策を実装できる

4. **実践的なアプリケーションが作れる**

   - CRUD機能を実装できる
   - ログイン機能を実装できる
   - REST APIを設計・実装できる

5. **自走できる**

   - わからないことを調べられる
   - エラーメッセージを読んで問題を解決できる
   - 新しい技術を学ぶ方法を知っている

6. **学習を楽しんでいる**
   - 「もっと学びたい」と思える
   - 成長を実感できる
   - セキュリティ対策も楽しめる

---

**Let's create an amazing and secure learning experience for vibe coders!**

# 総合プロジェクト1: Simple Blog Database 📝

**学習目標**：Phase 3で学んだMySQL基礎をすべて使って、ブログシステムのデータベースを設計・実装する！

---

## 📖 プロジェクト概要

このプロジェクトでは、**シンプルなブログシステムのデータベース**を作成します。

ユーザーが投稿を書き、カテゴリで分類できるブログの基本機能を実現するデータベースを設計・実装するよ！

---

## 🎯 学べること

- リレーショナルデータベースの設計（1対多の関係）
- 主キーと外部キーの実践
- 適切なデータ型の選択
- CRUD操作（CREATE、INSERT、SELECT、UPDATE、DELETE）
- phpMyAdminを使ったデータベース管理

---

## 🏗️ 機能要件

### ユーザー管理

- ユーザー情報を格納
- ユーザー名、メールアドレス、登録日時を管理
- メールアドレスは一意（重複不可）

### 投稿管理

- ブログ投稿を格納
- タイトル、本文、投稿日時を管理
- 投稿は必ずユーザーに紐づく
- 投稿は必ずカテゴリに属する

### カテゴリ管理

- カテゴリ情報を格納
- カテゴリ名を管理
- カテゴリ名は一意（重複不可）

---

## 📊 テーブル設計

### ER図（テーブル間の関係）

```text
users（1人のユーザー）
   ↓ 1対多
posts（複数の投稿）

categories（1つのカテゴリ）
   ↓ 1対多
posts（複数の投稿）

つまり：
- 1人のユーザーは複数の投稿を書ける
- 1つのカテゴリには複数の投稿が属する
```

### usersテーブル

ユーザー情報を格納するテーブル。

| カラム名   | データ型      | 制約                                 | 説明         |
| ---------- | ------------- | ------------------------------------ | ------------ |
| id         | INT           | PRIMARY KEY, AUTO_INCREMENT          | ユーザーID   |
| username   | VARCHAR(50)   | UNIQUE, NOT NULL                     | ユーザー名   |
| email      | VARCHAR(255)  | UNIQUE, NOT NULL                     | メールアドレス |
| created_at | TIMESTAMP     | DEFAULT CURRENT_TIMESTAMP            | 登録日時     |

**主キー**：`id`

### categoriesテーブル

カテゴリ情報を格納するテーブル。

| カラム名 | データ型     | 制約                        | 説明           |
| -------- | ------------ | --------------------------- | -------------- |
| id       | INT          | PRIMARY KEY, AUTO_INCREMENT | カテゴリID     |
| name     | VARCHAR(100) | UNIQUE, NOT NULL            | カテゴリ名     |

**主キー**：`id`

### postsテーブル

ブログ投稿を格納するテーブル。

| カラム名    | データ型      | 制約                                 | 説明                     |
| ----------- | ------------- | ------------------------------------ | ------------------------ |
| id          | INT           | PRIMARY KEY, AUTO_INCREMENT          | 投稿ID                   |
| user_id     | INT           | NOT NULL, FOREIGN KEY                | ユーザーID（外部キー）   |
| category_id | INT           | NOT NULL, FOREIGN KEY                | カテゴリID（外部キー）   |
| title       | VARCHAR(200)  | NOT NULL                             | タイトル                 |
| content     | TEXT          | NOT NULL                             | 本文                     |
| created_at  | TIMESTAMP     | DEFAULT CURRENT_TIMESTAMP            | 投稿日時                 |

**主キー**：`id`

**外部キー**：
- `user_id` → `users(id)`を参照
- `category_id` → `categories(id)`を参照

---

## 💻 実装

### データベースとテーブルの作成

完全なSQL定義は`database.sql`を参照してください。

👉 **[database.sqlを見る](database.sql)**

### phpMyAdminでの実行手順

1. **phpMyAdminにアクセス**
   - MAMP起動後、ブラウザで`http://localhost:8888/phpMyAdmin/`にアクセス

2. **database.sqlの内容をコピー**
   - `database.sql`ファイルの内容を全てコピー

3. **SQLタブで実行**
   - phpMyAdminで「SQL」タブをクリック
   - コピーしたSQLをペースト
   - 「実行」ボタンをクリック

4. **確認**
   - 左側のデータベース一覧から`blog_db`を選択
   - `users`、`categories`、`posts`テーブルが作成されているか確認
   - 各テーブルをクリックして、サンプルデータが挿入されているか確認

---

## 🔍 サンプルデータ

### users（3人のユーザー）

| id  | username | email                 |
| --- | -------- | --------------------- |
| 1   | taro     | taro@example.com      |
| 2   | hanako   | hanako@example.com    |
| 3   | jiro     | jiro@example.com      |

### categories（5つのカテゴリ）

| id  | name         |
| --- | ------------ |
| 1   | 技術         |
| 2   | ライフスタイル |
| 3   | 旅行         |
| 4   | 料理         |
| 5   | 音楽         |

### posts（8件の投稿）

| id  | user_id | category_id | title                  |
| --- | ------- | ----------- | ---------------------- |
| 1   | 1       | 1           | PHP入門                |
| 2   | 1       | 1           | MySQL基礎              |
| 3   | 2       | 2           | 朝のルーティン         |
| 4   | 2       | 3           | 京都旅行記             |
| 5   | 3       | 4           | 簡単パスタレシピ       |
| 6   | 1       | 1           | データベース設計のコツ |
| 7   | 2       | 5           | お気に入りの音楽       |
| 8   | 3       | 2           | 読書習慣の作り方       |

---

## 💪 実践課題

データベースを作成したら、以下の課題にチャレンジしよう！

### 課題1: 基本的なSELECT

以下のデータを取得するSQLを書いてください：

1. 全ユーザーを取得
2. 全カテゴリを取得
3. 全投稿を取得
4. 特定のユーザー（taro）の投稿を取得
5. 特定のカテゴリ（技術）の投稿を取得

### 課題2: データの挿入

以下のデータを挿入してください：

1. 新しいユーザーを追加（username: "keiko", email: "keiko@example.com"）
2. 新しいカテゴリを追加（name: "スポーツ"）
3. 新しい投稿を追加（user_id: 4（keiko）, category_id: 6（スポーツ）, title: "ランニングのすすめ", content: "毎朝走っています！"）

### 課題3: データの更新

以下のデータを更新してください：

1. ユーザー「taro」のメールアドレスを「newtaro@example.com」に変更
2. 投稿「PHP入門」のタイトルを「PHP入門 - 基礎編」に変更
3. カテゴリ「技術」の名前を「テクノロジー」に変更

### 課題4: データの削除

以下のデータを削除してください：

1. ユーザー「jiro」が書いた全ての投稿を削除
2. カテゴリ「音楽」に属する全ての投稿を削除

**注意**：外部キー制約があるため、参照されているデータは削除できません。先に参照している側（posts）を削除してから、参照される側（usersやcategories）を削除する必要があります。

### 課題5: 高度なクエリ

以下のデータを取得するSQLを書いてください：

1. 投稿数が多い順にユーザーを表示（ヒント：Lesson 04、Phase 4で学ぶJOINとGROUP BYが必要）
2. 最新の5件の投稿を取得
3. 「技術」カテゴリの投稿を投稿日時の降順で取得

---

## 🤖 バイブコーディング実践

### AIに指示を出してみよう

このプロジェクトをAIと一緒に作る場合の指示例：

**良い指示の例**：

```text
「ブログシステムのデータベースを設計してください。

以下の3つのテーブルが必要です：

1. usersテーブル（ユーザー情報）
   - id（主キー、自動増分）
   - username（ユーザー名、必須、一意、最大50文字）
   - email（メールアドレス、必須、一意、最大255文字）
   - created_at（登録日時、デフォルト：現在時刻）

2. categoriesテーブル（カテゴリ情報）
   - id（主キー、自動増分）
   - name（カテゴリ名、必須、一意、最大100文字）

3. postsテーブル（投稿情報）
   - id（主キー、自動増分）
   - user_id（外部キー、usersテーブルのidを参照、必須）
   - category_id（外部キー、categoriesテーブルのidを参照、必須）
   - title（タイトル、必須、最大200文字）
   - content（本文、必須、TEXT型）
   - created_at（投稿日時、デフォルト：現在時刻）

テーブル間の関係：
- 1人のユーザー → 複数の投稿（1対多）
- 1つのカテゴリ → 複数の投稿（1対多）

MySQLのCREATE TABLE文で出力してください。
データベース名は「blog_db」を使用してください。」
```

### 生成されたSQLのチェックポイント

- [ ] **データベースの作成**
  - `CREATE DATABASE`文があるか
  - 文字コード設定（utf8mb4）があるか

- [ ] **主キーの設定**
  - 全テーブルに`id`カラム（PRIMARY KEY、AUTO_INCREMENT）があるか

- [ ] **外部キーの設定**
  - `posts.user_id` → `users.id`の参照があるか
  - `posts.category_id` → `categories.id`の参照があるか

- [ ] **制約の設定**
  - NOT NULL：必須項目に設定されているか
  - UNIQUE：username、email、カテゴリ名に設定されているか
  - DEFAULT：created_atにCURRENT_TIMESTAMPが設定されているか

- [ ] **データ型の選択**
  - VARCHAR：適切な長さが設定されているか
  - TEXT：長い文字列（本文）に使われているか
  - TIMESTAMP：日時に使われているか

---

## ✅ まとめ

このプロジェクトで学んだこと：

- ✅ リレーショナルデータベースの設計（1対多の関係）
- ✅ 主キーと外部キーの実践的な使い方
- ✅ 適切なデータ型の選択（VARCHAR、TEXT、TIMESTAMP）
- ✅ 制約の設定（PRIMARY KEY、FOREIGN KEY、UNIQUE、NOT NULL、DEFAULT）
- ✅ データの重複を避ける設計
- ✅ phpMyAdminを使ったデータベース管理

---

## 🚀 次のステップ

おめでとう！シンプルなブログシステムのデータベースを作成できたね！✨

次は**プロジェクト2: 商品管理データベース**に挑戦しよう！

より複雑なテーブル設計と、実用的なクエリを学べるよ！

👉 **[プロジェクト2: 商品管理データベースへ進む](../product-management-db/README.md)**

---

**Let's vibe and code! 🎉**

Phase 3で学んだMySQL基礎を使って、実践的なデータベースを作れるようになったね！
